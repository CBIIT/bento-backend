
- name: Check if tmp directory exist
  stat:
    path: "{{workspace}}/tmp"
  register: stat_result

- name: remove the tmp if exists
  file:
    path: "{{workspace}}/tmp"
    state: absent
  when: stat_result.stat.exists == True

- name: copy config-sample.json config.json
  copy:
    remote_src: yes
    src: "{{workspace}}/config/config-sample.json"
    dest: "{{workspace}}/config/config.json"

- name: change dummy armId,phsID,bucket name and env
  lineinfile:
    dest: "{{workspace}}/config/config.json"
    regexp: "^{{item.key}}"
    line: "{{item.key}}:{{item.value}}"
  loop:
    "{{match_vars|dict2items}}"

- name: show file content
  command: cat {{workspace}}/config/config.json
  register: content

- name: show config.json content
  debug:
    msg: "{{ content.stdout}}"

# - name: execute file loader script
#   shell:
#     cmd: >
#       /usr/bin/python3
#       matchMain.py
#       {{workspace}}/config/config.json
#     chdir: "{{workspace}}"
#   register: file_loader
#   when: wipe_db == "no"

# - name: show dataloader output
#   debug:
#     msg: "{{data_loader}}"

