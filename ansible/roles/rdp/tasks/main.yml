--- 
- name: "install gui utilities and xrdp"
  yum: 
    name: 
      - "@General Purpose Desktop"
      - "@Development Tools"
      - tigervnc-server
      - xrdp
    state: latest

- name: "enable gui on bootup"
  file: 
    dest: /etc/systemd/system/default.target
    src: /lib/systemd/system/runlevel5.target
    state: link
  
- name: "open rdp port 3389"
  firewalld: 
    immediate: true
    permanent: true
    port: 3389/tcp
    state: enabled

- name: apply selinux
  command: "{{ item }}"
  loop:
    - chcon --type=bin_t /usr/sbin/xrdp
    - chcon --type=bin_t /usr/sbin/xrdp-sesman
    
- name: "start and enable xrdp"
  service: 
    enabled: true
    name: xrdp
    state: started

- name: reboot
  reboot: 
