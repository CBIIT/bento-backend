---
# - name: install dependencies
#   shell: ansible-galaxy collection install community.general
#   register: output

# - debug:
#     msg: "{{output.stdout_lines}}"
# tasks file for url-monitor
- name: "check {{app_name | default(name)}} for availability"
  uri:
   url: "{{item | default(url)}}"
   follow_redirects: none
   method: GET
  register: result
  until: ('status' in result)
  retries: 100
  delay: 10

- name: send notification
  slack:
    token: "{{slack_token}}"
    attachments:
      - text: "{{custom_text | default(text)}}"
        title: "{{custom_title | default(title)}}"
        color: "good"
        footer: "icdc devops"
        ts: "{[ansible_date_time.epoch }}"
        mrkdwn_in: "{{mkdown}}"
#         fallback: "File Service Monitor"

# - name: show output
#   debug:
#     msg: "{{result.status}}"
