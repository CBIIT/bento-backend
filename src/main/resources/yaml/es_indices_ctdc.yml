# Indices settings
Indices:
  - index_name: cases
    type: neo4j
    mapping:
      case_id:
        type: keyword
      clinical_trial_id:
        type: keyword
      clinical_trial_designation:
        type: keyword
      pubmed_id:
        type: keyword
      gender:
        type: keyword
      race:
        type: keyword
      ethnicity:
        type: keyword
      disease:
        type: keyword
      trial_arm:
        type: keyword
      arm_id:
        type: keyword
      arm_treatment:
        type: keyword
      case_id_gs:
        type: search_as_you_type
      file_type:
        type: keyword
      file_format:
        type: keyword
    cypher_query: "
      MATCH (c:case)
      OPTIONAL MATCH (c)-[:of_arm]->(a:arm)-[:of_trial]->(ct:clinical_trial)
      OPTIONAL MATCH (f:file)-[*]->(c)
      RETURN DISTINCT 
        c.case_id AS case_id,
        c.case_id AS case_id_gs,
        ct.clinical_trial_id as clinical_trial_id,
        ct.clinical_trial_designation AS clinical_trial_designation,
        a.pubmed_id AS pubmed_id,
        c.gender AS gender,
        c.race AS race,
        c.ethnicity AS ethnicity,
        c.disease AS disease,
        a.arm_id+'_'+a.arm_drug AS trial_arm,
        a.arm_id AS arm_id,
        a.arm_drug AS arm_treatment,
        COLLECT(DISTINCT f.file_type) AS file_type,
        COLLECT(DISTINCT f.file_format) AS file_format
    "
  - index_name: files
    type: neo4j
    mapping:
      trial_code:
        type: keyword
      trial_id:
        type: keyword
      pubmed_id:
        type: keyword
      trial_arm:
        type: keyword
      diagnosis:
        type: keyword
      gender:
        type: keyword
      race:
        type: keyword
      ethnicity:
        type: keyword
      file_type:
        type: keyword
      file_format:
        type: keyword
      file_name:
        type: keyword
      association:
        type: keyword
      description:
        type: keyword
      size:
        type: keyword
      arm:
        type: keyword
      arm_id:
        type: keyword
      case_id:
        type: keyword
      uuid:
        type: keyword
      md5sum:
        type: keyword
      file_name_gs:
        type: search_as_you_type
      file_description_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH (f:file)
      OPTIONAL MATCH (f)-[*]->(a:arm)-[:of_trial]->(ct:clinical_trial)
      OPTIONAL MATCH (f)-[*]->(c:case)
      OPTIONAL MATCH (f)-->(parent)
      RETURN DISTINCT 
        ct.clinical_trial_designation AS trial_code,
        ct.clinical_trial_id as trial_id,
        a.pubmed_id AS pubmed_id,
        a.arm_id+'_'+a.arm_drug AS trial_arm,
        a.arm_id AS arm_id,
        c.disease AS diagnosis,
        c.gender AS gender,
        c.race AS race,
        c.ethnicity AS ethnicity,
        f.file_type AS file_type,
        f.file_format AS file_format,
        f.file_name AS file_name,
        f.file_name AS file_name_gs,
        head(labels(parent)) as association,
        f.file_description AS description,
        f.file_description AS file_description_gs,
        f.file_size AS size,
        a.arm_id AS arm,
        c.case_id AS case_id,
        f.uuid AS uuid,
        f.md5sum AS md5sum
    "  
  - index_name: clinical_trials
    type: neo4j
    mapping:
      clinical_trial_id:
        type: search_as_you_type
      clinical_trial_id_kw:
        type: keyword
      clinical_trial_short_name:
        type: search_as_you_type
      clinical_trial_long_name:
        type: search_as_you_type
      clinical_trial_designation:
        type: search_as_you_type
    cypher_query: "
      MATCH (ct:clinical_trial)
      RETURN DISTINCT 
        ct.clinical_trial_id AS clinical_trial_id,
        ct.clinical_trial_id AS clinical_trial_id_kw,
        ct.clinical_trial_short_name AS clinical_trial_short_name,
        ct.clinical_trial_long_name AS clinical_trial_long_name,
        ct.clinical_trial_designation AS clinical_trial_designation
    "
  - index_name: arms
    type: neo4j
    mapping:
      arm:
        type: search_as_you_type
      clinical_trial_id:
        type: search_as_you_type
      clinical_trial_id_kw:
        type: keyword
      arm_id:
        type: search_as_you_type
      arm_id_kw:
        type: keyword
      arm_drug:
        type: search_as_you_type
    cypher_query: "
      MATCH (a:arm)-[:of_trial]->(ct:clinical_trial)
      RETURN DISTINCT
        a.arm_id+'_'+ a.arm_drug AS arm,
        ct.clinical_trial_id AS clinical_trial_id,
        ct.clinical_trial_id AS clinical_trial_id_kw,
        a.arm_id AS arm_id,
        a.arm_id AS arm_id_kw,
        a.arm_drug AS arm_drug
    "
  - index_name: about_page
    type: about_file
    # type mapping for each property of the index
    mapping:
      page:
        type: search_as_you_type
      title:
        type: search_as_you_type
      primaryContentImage:
        type: text
      content:
        type: object
  - index_name: model_nodes
    type: model
    subtype: node
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      node_kw:
        type: keyword
  - index_name: model_properties
    type: model
    subtype: property
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      property:
        type: search_as_you_type
      property_kw:
        type: keyword
      property_description:
        type: search_as_you_type
      property_required:
        type: search_as_you_type
      property_type:
        type: search_as_you_type
  - index_name: model_values
    type: model
    subtype: value
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      property:
        type: search_as_you_type
      property_description:
        type: search_as_you_type
      property_required:
        type: search_as_you_type
      property_type:
        type: search_as_you_type
      value:
        type: search_as_you_type
      value_kw:
        type: keyword