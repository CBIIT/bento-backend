# Indices settings
Indices:
  - index_name: cases
    type: neo4j
    mapping:
      case_id:
        type: keyword
      clinical_trial_id:
        type: keyword
      clinical_trial_designation:
        type: keyword
      pubmed_id:
        type: keyword
      gender:
        type: keyword
      race:
        type: keyword
      ethnicity:
        type: keyword
      disease:
        type: keyword
      trial_arm:
        type: keyword
      arm_id:
        type: keyword
      arm_treatment:
        type: keyword
      uuid:
        type: keyword
      file_type:
        type: keyword
      file_format:
        type: keyword
      case_id_gs:
        type: search_as_you_type
      clinical_trial_id_gs:
        type: search_as_you_type
      clinical_trial_code_gs:
        type: search_as_you_type
      gender_gs:
        type: search_as_you_type
      race_gs:
        type: search_as_you_type
      disease_gs:
        type: search_as_you_type
      arm_id_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH (c:case)
      OPTIONAL MATCH (c)-[:of_arm]->(a:arm)-[:of_trial]->(ct:clinical_trial)
      OPTIONAL MATCH (f:file)-[*]->(c)
      RETURN DISTINCT 
        COALESCE(c.case_id, '') AS case_id,
        COALESCE(c.case_id, '') AS case_id_gs,
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id,
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id_gs,
        COALESCE(ct.clinical_trial_designation, '') AS clinical_trial_designation,
        COALESCE(ct.clinical_trial_designation, '') AS clinical_trial_code_gs,
        COALESCE(a.pubmed_id, '') AS pubmed_id,
        COALESCE(c.gender, '') AS gender,
        COALESCE(c.gender, '') AS gender_gs,
        COALESCE(c.race, '') AS race,
        COALESCE(c.race, '') AS race_gs,
        COALESCE(c.ethnicity, '') AS ethnicity,
        COALESCE(c.disease, '') AS disease,
        COALESCE(c.disease, '') AS disease_gs,
        COALESCE(a.arm_id+'_'+a.arm_drug, '') AS trial_arm,
        COALESCE(a.arm_id, '') AS arm_id,
        COALESCE(a.arm_id, '') AS arm_id_gs,
        COALESCE(a.arm_drug, '') AS arm_treatment,
        COLLECT(DISTINCT f.uuid) AS uuid,
        COLLECT(DISTINCT f.file_type) AS file_type,
        COLLECT(DISTINCT f.file_format) AS file_format
    "
  - index_name: files
    type: neo4j
    mapping:
      trial_code:
        type: keyword
      trial_id:
        type: keyword
      pubmed_id:
        type: keyword
      trial_arm:
        type: keyword
      disease:
        type: keyword
      gender:
        type: keyword
      race:
        type: keyword
      ethnicity:
        type: keyword
      file_type:
        type: keyword
      file_format:
        type: keyword
      file_name:
        type: keyword
      association:
        type: keyword
      description:
        type: keyword
      size:
        type: keyword
      arm:
        type: keyword
      arm_id:
        type: keyword
      case_id:
        type: keyword
      uuid:
        type: keyword
      md5sum:
        type: keyword
      file_name_gs:
        type: search_as_you_type
      file_description_gs:
        type: search_as_you_type
      file_type_gs:
        type: search_as_you_type
      file_format_gs:
        type: search_as_you_type
      file_size_gs:
        type: search_as_you_type
      clinical_trial_id_gs:
        type: search_as_you_type
      clinical_trial_code_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH (f:file)
      OPTIONAL MATCH (f)-[*]->(a:arm)-[:of_trial]->(ct:clinical_trial)
      OPTIONAL MATCH (f)-[*]->(c:case)
      OPTIONAL MATCH (f)-->(parent)
      RETURN DISTINCT 
        COALESCE(ct.clinical_trial_designation, '') AS trial_code,
        COALESCE(ct.clinical_trial_designation, '') AS clinical_trial_code_gs,
        COALESCE(ct.clinical_trial_id, '') AS trial_id,
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id_gs,
        COALESCE(a.pubmed_id, '') AS pubmed_id,
        COALESCE(a.arm_id+'_'+a.arm_drug, '') AS trial_arm,
        COALESCE(a.arm_id, '') AS arm_id,
        COALESCE(c.disease, '') AS disease,
        COALESCE(c.gender, '') AS gender,
        COALESCE(c.race, '') AS race,
        COALESCE(c.ethnicity, '') AS ethnicity,
        COALESCE(f.file_type, '') AS file_type,
        COALESCE(f.file_type, '') AS file_type_gs,
        COALESCE(f.file_format, '') AS file_format,
        COALESCE(f.file_format, '') AS file_format_gs,
        COALESCE(f.file_name, '') AS file_name,
        COALESCE(f.file_name, '') AS file_name_gs,
        COALESCE(head(labels(parent)), '') AS association,
        COALESCE(f.file_description, '') AS description,
        COALESCE(f.file_description, '') AS file_description_gs,
        COALESCE(f.file_size, 0) AS size,
        COALESCE(f.file_size, 0) AS file_size_gs,
        COALESCE(a.arm_id, '') AS arm,
        COALESCE(c.case_id, '') AS case_id,
        COALESCE(f.uuid, '') AS uuid,
        COALESCE(f.md5sum, '') AS md5sum
    "  
  - index_name: clinical_trials
    type: neo4j
    mapping:
      clinical_trial_id:
        type: search_as_you_type
      clinical_trial_id_kw:
        type: keyword
      clinical_trial_short_name:
        type: search_as_you_type
      clinical_trial_long_name:
        type: search_as_you_type
      clinical_trial_designation:
        type: search_as_you_type
    cypher_query: "
      MATCH (ct:clinical_trial)
      RETURN DISTINCT 
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id,
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id_kw,
        COALESCE(ct.clinical_trial_short_name, '') AS clinical_trial_short_name,
        COALESCE(ct.clinical_trial_long_name, '') AS clinical_trial_long_name,
        COALESCE(ct.clinical_trial_designation, '') AS clinical_trial_designation
    "
  - index_name: arms
    type: neo4j
    mapping:
      arm:
        type: search_as_you_type
      clinical_trial_id:
        type: search_as_you_type
      clinical_trial_id_kw:
        type: keyword
      arm_id:
        type: search_as_you_type
      arm_id_kw:
        type: keyword
      arm_drug:
        type: search_as_you_type
    cypher_query: "
      MATCH (a:arm)-[:of_trial]->(ct:clinical_trial)
      RETURN DISTINCT
        COALESCE(a.arm_id+'_'+ a.arm_drug, '') AS arm,
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id,
        COALESCE(ct.clinical_trial_id, '') AS clinical_trial_id_kw,
        COALESCE(a.arm_id, '') AS arm_id,
        COALESCE(a.arm_id, '') AS arm_id_kw,
        COALESCE(a.arm_drug, '') AS arm_drug
    "
  - index_name: about_page
    type: about_file
    # type mapping for each property of the index
    mapping:
      page:
        type: search_as_you_type
      title:
        type: search_as_you_type
      primaryContentImage:
        type: text
      content:
        type: object
  - index_name: model_nodes
    type: model
    subtype: node
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      node_kw:
        type: keyword
  - index_name: model_properties
    type: model
    subtype: property
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      property:
        type: search_as_you_type
      property_kw:
        type: keyword
      property_description:
        type: search_as_you_type
      property_required:
        type: search_as_you_type
      property_type:
        type: search_as_you_type
  - index_name: model_values
    type: model
    subtype: value
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      property:
        type: search_as_you_type
      property_description:
        type: search_as_you_type
      property_required:
        type: search_as_you_type
      property_type:
        type: search_as_you_type
      value:
        type: search_as_you_type
      value_kw:
        type: keyword