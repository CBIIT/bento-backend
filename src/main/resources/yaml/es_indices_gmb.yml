Indices:
  # Subjects Index
  - index_name: subjects
    type: neo4j
    mapping:
      subject_ids:
        type: keyword
      race: 
        type: keyword
      disease_term: 
        type: keyword
      registering_institution:
        type: keyword
      patient_subgroup:
        type: keyword
      stage_at_entry:
        type: keyword
      cause_of_death:
        type: keyword
      sites_of_disease_at_autopsy:
        type: keyword
      source_of_the_lab_data:
        type: keyword
      lab_test:
        type: keyword
      system_organ_class:
        type: keyword
      serious: 
        type: keyword
      outcome: 
        type: keyword
      somatic_pathogenicity:
        type: keyword
      germline_pathogenicity:
        type: keyword
      file_type:
        type: keyword
      clinical_trial_id:
        type: keyword
      files:
        type: keyword
      subject_id_gs:
        type: search_as_you_type
      registering_institution_gs:
        type: search_as_you_type
      disease_term_gs:
        type: search_as_you_type
      clinical_trial_id_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH (s:SUBJECT)-->(ct:CLINICALTRIAL)
      OPTIONAL MATCH (e:ENROLLMENT)-->(s)
      OPTIONAL MATCH (srv:SURVIVAL)-->(s)
      OPTIONAL MATCH (l:LABORATORY)-->(s)
      OPTIONAL MATCH (ae:ADVERSE_EVENTS)-->(s)
      OPTIONAL MATCH (s)<--(sv:SOMATIC_VARIANT)
      OPTIONAL MATCH (s)<--(gv:GERMLINE_VARIANT)
      OPTIONAL MATCH (s)<--(f:FILE)
      WITH
        coalesce(ct.CLINICAL_TRIAL_ID, 'N/A') AS clinical_trial_id,
        coalesce(ct.CLINICAL_TRIAL_ID, 'N/A') AS clinical_trial_id_gs,
        coalesce(s.PT_ID, 'N/A') AS subject_ids,
        coalesce(s.PT_ID, 'N/A') AS subject_id_gs,
        coalesce(s.PT_RACE_CD_1, 'N/A') AS race,
        coalesce(s.DZ_DX_NM, 'N/A') AS disease_term,
        coalesce(s.DZ_DX_NM, 'N/A') AS disease_term_gs,
        coalesce(s.REG_INST_ID_CD, 'N/A') AS registering_institution,
        coalesce(s.REG_INST_ID_CD, 'N/A') AS registering_institution_gs,
        coalesce(s.PT_SUBGRP_ASSIGN_TP, 'N/A') AS patient_subgroup,
        COLLECT(DISTINCT e.DISEAS_STG) AS stage_at_entry,
        COLLECT(DISTINCT srv.DEATH_CAUS_CD) AS cause_of_death,
        COLLECT(DISTINCT srv.ATPSY_DZ_SITE_NM) AS sites_of_disease_at_autopsy,
        COLLECT(DISTINCT l.LAB_DATA_SRCE_NM) AS source_of_the_lab_data,
        COLLECT(DISTINCT l.LAB_TEST_NM) AS lab_test,
        COLLECT(DISTINCT ae.MEDDRA_SOC_TRM_NM) AS system_organ_class,
        COLLECT(DISTINCT ae.SAE_RSN) AS serious,
        COLLECT(DISTINCT ae.AE_OUTCOME) AS outcome,
        COLLECT(DISTINCT gv.GRMLN_VAR_PTHGNC_CAT) AS germline_pathogenicity,
        COLLECT(DISTINCT sv.SOMATIC_VAR_PTHGNC_CAT) AS somatic_pathogenicity,
        COLLECT(DISTINCT f.FILE_TYPE) AS file_type,
        COLLECT(DISTINCT f.UUID) AS files
      RETURN
        clinical_trial_id,
        clinical_trial_id_gs,
        subject_ids,
        subject_id_gs,
        race,
        disease_term,
        disease_term_gs,
        registering_institution,
        registering_institution_gs,
        patient_subgroup,
        CASE size(stage_at_entry) WHEN 0 THEN 'N/A' WHEN 1 THEN head(stage_at_entry) ELSE stage_at_entry END AS stage_at_entry,
        CASE size(cause_of_death) WHEN 0 THEN 'N/A' WHEN 1 THEN head(cause_of_death) ELSE cause_of_death END AS cause_of_death,
        CASE size(sites_of_disease_at_autopsy) WHEN 0 THEN 'N/A' WHEN 1 THEN head(sites_of_disease_at_autopsy) ELSE sites_of_disease_at_autopsy END AS sites_of_disease_at_autopsy,
        CASE size(source_of_the_lab_data) WHEN 0 THEN 'N/A' WHEN 1 THEN head(source_of_the_lab_data) ELSE source_of_the_lab_data END AS source_of_the_lab_data,
        CASE size(lab_test) WHEN 0 THEN 'N/A' WHEN 1 THEN head(lab_test) ELSE lab_test END AS lab_test,
        CASE size(system_organ_class) WHEN 0 THEN 'N/A' WHEN 1 THEN head(system_organ_class) ELSE system_organ_class END AS system_organ_class,
        CASE size(serious) WHEN 0 THEN 'N/A' WHEN 1 THEN head(serious) ELSE serious END AS serious,
        CASE size(outcome) WHEN 0 THEN 'N/A' WHEN 1 THEN head(outcome) ELSE outcome END AS outcome,
        CASE size(germline_pathogenicity) WHEN 0 THEN 'N/A' WHEN 1 THEN head(germline_pathogenicity) ELSE germline_pathogenicity END AS germline_pathogenicity,
        CASE size(somatic_pathogenicity) WHEN 0 THEN 'N/A' WHEN 1 THEN head(somatic_pathogenicity) ELSE somatic_pathogenicity END AS somatic_pathogenicity,
        CASE size(file_type) WHEN 0 THEN 'N/A' WHEN 1 THEN head(file_type) ELSE file_type END AS file_type,
        files
    "
  # Files Index
  - index_name: files
    type: neo4j
    mapping:
      file_id:
        type: keyword
      file_name:
        type: keyword
      file_names:
        type: keyword
      file_description:
        type: keyword
      file_format:
        type: keyword
      file_size:
        type: keyword
      clinical_trial_id:
        type: keyword
      trial_short_name:
        type: keyword
      arm:
        type: keyword
      subject_ids:
        type: keyword
      race:
        type: keyword
      disease_term:
        type: keyword
      registering_institution:
        type: keyword
      patient_subgroup:
        type: keyword
      stage_at_entry:
        type: keyword
      cause_of_death:
        type: keyword
      sites_of_disease_at_autopsy:
        type: keyword
      source_of_the_lab_data:
        type: keyword
      lab_test:
        type: keyword
      system_organ_class:
        type: keyword
      serious:
        type: keyword
      outcome:
        type: keyword
      somatic_pathogenicity:
        type: keyword
      germline_pathogenicity:
        type: keyword
      file_type:
        type: keyword
      md5sum:
        type: keyword
      file_id_gs:
        type: search_as_you_type
      file_name_gs:
        type: search_as_you_type
      file_description_gs:
        type: search_as_you_type
      clinical_trial_id_gs:
        type: search_as_you_type
      subject_id_gs:
        type: search_as_you_type
      file_format_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH (f:FILE)
      OPTIONAL MATCH (f)-->(s:SUBJECT)-->(ct:CLINICALTRIAL)
      OPTIONAL MATCH (e:ENROLLMENT)-->(s)
      OPTIONAL MATCH (srv:SURVIVAL)-->(s)
      OPTIONAL MATCH (l:LABORATORY)-->(s)
      OPTIONAL MATCH (ae:ADVERSE_EVENTS)-->(s)
      OPTIONAL MATCH (s)<--(sv:SOMATIC_VARIANT)
      OPTIONAL MATCH (s)<--(gv:GERMLINE_VARIANT)
      RETURN DISTINCT
        f.UUID AS file_id,
        f.UUID AS file_id_gs,
        f.FILE_NAME AS file_name,
        f.FILE_NAME AS file_names,
        f.FILE_NAME AS file_name_gs,
        f.FILE_DESCRIPTION AS file_description,
        f.FILE_DESCRIPTION AS file_description_gs,
        f.FILE_FORMAT AS file_format,
        f.FILE_FORMAT AS file_format_gs,
        f.FILE_SIZE AS file_size,
        ct.CLINICAL_TRIAL_ID AS clinical_trial_id,
        ct.CLINICAL_TRIAL_ID AS clinical_trial_id_gs,
        ct.CLINICAL_TRIAL_SHORT_NAME AS trial_short_name,
        s.ARM AS arm,
        s.PT_ID AS subject_ids,
        s.PT_ID AS subject_id_gs,
        s.PT_RACE_CD_1 AS race,
        s.DZ_DX_NM AS disease_term,
        s.REG_INST_ID_CD AS registering_institution,
        s.PT_SUBGRP_ASSIGN_TP AS patient_subgroup,
        e.DISEAS_STG AS stage_at_entry,
        srv.DEATH_CAUS_CD AS cause_of_death,
        srv.ATPSY_DZ_SITE_NM AS sites_of_disease_at_autopsy,
        l.LAB_DATA_SRCE_NM AS source_of_the_lab_data,
        l.LAB_TEST_NM AS lab_test,
        ae.MEDDRA_SOC_TRM_NM AS system_organ_class,
        ae.SAE_RSN AS serious,
        ae.AE_OUTCOME AS outcome,
        gv.GRMLN_VAR_PTHGNC_CAT AS germline_pathogenicity,
        sv.SOMATIC_VAR_PTHGNC_CAT AS somatic_pathogenicity,
        f.FILE_TYPE AS file_type,
        f.MD5SUM AS md5sum
    "
  # Trials Index
  - index_name: trials
    type: neo4j
    mapping:
      trial_name:
        type: keyword
      trial_name_gs:
        type: search_as_you_type
      trial_long_name:
        type: keyword
      trial_long_name_gs:
        type: search_as_you_type
      trial_id:
        type: keyword
      trial_id_gs:
        type: search_as_you_type
      trial_description:
        type: keyword
      trial_description_gs:
        type: search_as_you_type
      trial_type:
        type: keyword
      trial_type_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH(ct:CLINICALTRIAL)
      RETURN DISTINCT
        ct.CLINICAL_TRIAL_SHORT_NAME AS trial_name,
        ct.CLINICAL_TRIAL_SHORT_NAME AS trial_name_gs,
        ct.CLINICAL_TRIAL_LONG_NAME AS trial_long_name,
        ct.CLINICAL_TRIAL_LONG_NAME AS trial_long_name_gs,
        ct.CLINICAL_TRIAL_ID AS trial_id,
        ct.CLINICAL_TRIAL_ID AS trial_id_gs,
        ct.CLINICAL_TRIAL_DESCRIPTION AS trial_description,
        ct.CLINICAL_TRIAL_DESCRIPTION AS trial_description_gs,
        ct.CLINICAL_TRIAL_TYPE AS trial_type,
        ct.CLINICAL_TRIAL_TYPE AS trial_type_gs
    "
  # Sites Index
  - index_name: sites
    type: neo4j
    mapping:
      site_id:
        type: keyword
      site_id_gs:
        type: search_as_you_type
      site_name_gs:
        type: search_as_you_type
      site_address_gs:
          type: search_as_you_type
      site_status_gs:
        type: search_as_you_type
      clinical_trial_id_gs:
        type: search_as_you_type
    cypher_query: "
      MATCH (site:SITE)
      OPTIONAL MATCH (site)-->(ct:CLINICALTRIAL)
      RETURN DISTINCT
        site.uuid AS site_id,
        site.uuid AS site_id_gs,
        site.REG_INST_ID AS site_name_gs,
        site.EMAIL AS site_address_gs,
        site.STATUS AS site_status_gs,
        ct.CLINICAL_TRIAL_ID AS clinical_trial_id_gs
    "
  # About Page Index
  - index_name: about_page
    type: about_file
    # type mapping for each property of the index
    mapping:
      page:
        type: search_as_you_type
      title:
        type: search_as_you_type
      primaryContentImage:
        type: text
      content:
        type: object
  # Model Nodes Index
  - index_name: model_nodes
    type: model
    subtype: node
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      node_kw:
        type: keyword
  # Model Properties Index
  - index_name: model_properties
    type: model
    subtype: property
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      property:
        type: search_as_you_type
      property_kw:
        type: keyword
      property_description:
        type: search_as_you_type
      property_required:
        type: search_as_you_type
      property_type:
        type: search_as_you_type
  # Model Values Index
  - index_name: model_values
    type: model
    subtype: value
    # type mapping for each property of the index
    mapping:
      node:
        type: search_as_you_type
      property:
        type: search_as_you_type
      property_description:
        type: search_as_you_type
      property_required:
        type: search_as_you_type
      property_type:
        type: search_as_you_type
      value:
        type: search_as_you_type
      value_kw:
        type: keyword