queries:
  - name: searchCases
    returnFields:
    - name: numberOfStudies
      index:
        - cases
      filter:
        # Get total number of documents in ES index
        selectedField: study
        type: aggregation
      result:
        type: int
        method: count_bucket_keys
    - name: numberOfCases
      index:
        - cases
      filter:
        # Get total number of documents in ES index
        type: default
      result:
        type: int_total_count
    - name: numberOfSamples
      index:
        - samples
      filter:
        # Get total number of documents in ES index
        type: default
      result:
        type: int_total_count
    - name: numberOfFiles
      index:
        - files
      filter:
        # Get total number of documents in ES index
        type: default
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      result:
        type: int_total_count
#      TODO WITHOUT Access CODE
    - name: filterCaseCountByStudyCode
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: study_code
      result:
        type: icdc_aggregation
# TODO change selected_field

    - name: numberOfStudyFiles
      index:
        - files
      filter:
        type: aggregation
        selectedField: study_files
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      result:
        type: int
        method: count_bucket_keys
    - name: numberOfPrograms
      index:
        - cases
      filter:
        type: nested
        selectedField: program
        nestedParameters:
          - program
        nestedPath: program_info
      result:
        type: int
        method: nested_count
      resultType: nested_int_total_count
    - name: numberOfAliquots
      index:
        - cases
      filter:
        # Get total number of documents in ES index
        type: default
      result:
        type: empty
    - name: volumeOfData
      index:
        - files
      filter:
        type: sum
        selectedField: file_size
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      result:
        type: float
        method: sum
    - name: caseCountByGender
      index:
        - cases
      filter:
        type: aggregation
        selectedField: sex
      result:
        type: icdc_aggregation
    - name: caseCountByBreed
      index:
        - cases
      filter:
        type: aggregation
        selectedField: breed
      result:
        type: icdc_aggregation
    - name: caseCountByBiobank
      index:
        - cases
      filter:
        type: aggregation
        selectedField: biobank
      result:
        type: icdc_aggregation
    - name: filterCaseCountByBiobank
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: biobank
      result:
        type: icdc_aggregation
    - name: caseCountByNeuteredStatus
      index:
        - cases
      filter:
        type: aggregation
        selectedField: neutered_status
      result:
        type: icdc_aggregation
    - name: caseCountByStageOfDisease
      index:
        - cases
      filter:
        type: aggregation
        selectedField: stage_of_disease
      result:
        type: icdc_aggregation
    - name: caseCountByDiseaseSite
      index:
        - cases
      filter:
        type: aggregation
        selectedField: disease_site
      resultType: icdc_aggregation
    - name: caseCountByDiagnosis
      index:
        - cases
      filter:
        type: aggregation
        selectedField: diagnosis
      result:
        type: icdc_aggregation

    - name: filterCaseCountByProgram
      index:
        - cases
      filter:
        type: nested
        selectedField: program
        ignoreSelectedField: true
        nestedPath: program_info
        nestedParameters:
          - program
      result:
        type: icdc_nested_list
    - name: filterCaseCountByStudyType
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: study_type
      resultType: icdc_aggregation
    - name: filterCaseCountByDiagnosis
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: diagnosis
      result:
        type: icdc_aggregation
    - name: filterCaseCountByBreed
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: breed
      result:
        type: icdc_aggregation
    - name: filterCaseCountByDiseaseSite
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: disease_site
      result:
        type: icdc_aggregation
    - name: filterCaseCountByStageOfDisease
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: stage_of_disease
      result:
        type: icdc_aggregation
    - name: filterCaseCountByResponseToTreatment
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: response_to_treatment
      result:
        type: icdc_aggregation
    - name: filterCaseCountBySex
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: sex
      result:
        type: icdc_aggregation
    - name: filterCaseCountByNeuteredStatus
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: neutered_status
      result:
        type: icdc_aggregation
    - name: filterCaseCountBySampleType
      index:
        - files
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: sample_type
      result:
        type: icdc_aggregation
    - name: filterCaseCountBySamplePathology
      index:
        - files
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: sample_pathology
      result:
        type: icdc_aggregation
    - name: filterCaseCountBySampleSite
      index:
        - files
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: sample_site
      result:
        type: icdc_aggregation
    - name: filterCaseCountByFileAssociation
      index:
        - files
      filter:
        type: aggregation
        selectedField: file_association
        ignoreSelectedField: true
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      result:
        type: icdc_aggregation
    - name: filterCaseCountByFileType
      index:
        - files
      filter:
        type: aggregation
        selectedField: file_type
        ignoreSelectedField: true
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      result:
        type: icdc_aggregation
    - name: filterCaseCountByFileFormat
      index:
        - files
      filter:
        type: aggregation
        selectedField: file_format
        ignoreSelectedField: true
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      result:
        type: icdc_aggregation
    - name: filterCaseCountByStudyParticipation
      index:
        - cases
      filter:
        type: aggregation
        ignoreSelectedField: true
        selectedField: study_participation
      result:
        type: icdc_aggregation
    - name: caseCountByProgram
      index:
        - cases
      filter:
        type: nested
        selectedField: program
        nestedPath: program_info
        nestedParameters:
          - program
      result:
        type: icdc_nested_list
    - name: caseCountByStudyCode
      index:
        - cases
      filter:
        type: aggregation
        selectedField: study_code
      result:
        type: icdc_aggregation
    - name: caseCountByStudyType
      index:
        - cases
      filter:
        type: aggregation
        selectedField: study_type
      result:
        type: icdc_aggregation
    - name: caseCountByStudyParticipation
      index:
        - cases
      filter:
        type: aggregation
        selectedField: study_participation
      result:
        type: icdc_aggregation
    - name: caseCountByFileFormat
      index:
        - files
      filter:
        type: aggregation
        selectedField: file_format
      result:
        type: icdc_aggregation
    - name: programsAndStudies
      index:
        - cases
      filter:
        type: sub_aggregation
        selectedField: program
        #        selectedField: program
        subAggSelectedField: study
#      TODO Duplicate Arm Program
      result:
        type: icdc_arm_program