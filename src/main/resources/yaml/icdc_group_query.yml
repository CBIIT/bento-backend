groups:
  - name: searchCases
    query:
    - name: numberOfStudies
      index:
        - cases
      filterType:
        # Get total number of documents in ES index
        selectedField: study
        type: aggregation
      resultType: int_total_aggregation
    - name: numberOfCases
      index:
        - cases
      filterType:
        # Get total number of documents in ES index
        type: number_of_docs
      resultType: int_total_count
    - name: numberOfSamples
      index:
        - samples
      filterType:
        # Get total number of documents in ES index
        type: number_of_docs
      resultType: int_total_count
    - name: numberOfFiles
      index:
        - files
      filterType:
        # Get total number of documents in ES index
        type: number_of_docs
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      resultType: int_total_count
#      TODO WITHOUT Access CODE
    - name: filterCaseCountByStudyCode
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: study_code
      resultType: icdc_aggregation
# TODO change selected_field

    - name: numberOfStudyFiles
      index:
        - files
      filterType:
        type: aggregation
        selectedField: study_files
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      resultType: int_total_aggregation
    - name: numberOfPrograms
      index:
        - cases
      filterType:
        type: nested
        selectedField: program
        nestedFields:
          - program
        nestedPath: program_info
      resultType: nested_int_total_count
    - name: numberOfAliquots
      index:
        - cases
      filterType:
        # Get total number of documents in ES index
        type: number_of_docs
      resultType: empty
    - name: volumeOfData
      index:
        - files
      filterType:
        type: sum
        selectedField: file_size
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      resultType: sum
    - name: caseCountByGender
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: sex
      resultType: icdc_aggregation
    - name: caseCountByBreed
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: breed
      resultType: icdc_aggregation
    - name: caseCountByBiobank
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: biobank
      resultType: icdc_aggregation
    - name: filterCaseCountByBiobank
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: biobank
      resultType: icdc_aggregation
    - name: caseCountByNeuteredStatus
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: neutered_status
      resultType: icdc_aggregation
    - name: caseCountByStageOfDisease
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: stage_of_disease
      resultType: icdc_aggregation
    - name: caseCountByDiseaseSite
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: disease_site
      resultType: icdc_aggregation
    - name: caseCountByDiagnosis
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: diagnosis
      resultType: icdc_aggregation

    - name: filterCaseCountByProgram
      index:
        - cases
      filterType:
        type: nested
        selectedField: program
        filter: true
        nestedPath: program_info
        nestedFields:
          - program
      resultType: icdc_nested_list
    - name: filterCaseCountByStudyType
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: study_type
      resultType: icdc_aggregation
    - name: filterCaseCountByDiagnosis
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: diagnosis
      resultType: icdc_aggregation
    - name: filterCaseCountByBreed
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: breed
      resultType: icdc_aggregation
    - name: filterCaseCountByDiseaseSite
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: disease_site
      resultType: icdc_aggregation
    - name: filterCaseCountByStageOfDisease
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: stage_of_disease
      resultType: icdc_aggregation
    - name: filterCaseCountByResponseToTreatment
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: response_to_treatment
      resultType: icdc_aggregation
    - name: filterCaseCountBySex
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: sex
      resultType: icdc_aggregation
    - name: filterCaseCountByNeuteredStatus
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: neutered_status
      resultType: icdc_aggregation
    - name: filterCaseCountBySampleType
      index:
        - files
      filterType:
        type: aggregation
        filter: true
        selectedField: sample_type
      resultType: icdc_aggregation
    - name: filterCaseCountBySamplePathology
      index:
        - files
      filterType:
        type: aggregation
        filter: true
        selectedField: sample_pathology
      resultType: icdc_aggregation
    - name: filterCaseCountBySampleSite
      index:
        - files
      filterType:
        type: aggregation
        filter: true
        selectedField: sample_site
      resultType: icdc_aggregation
    - name: filterCaseCountByFileAssociation
      index:
        - files
      filterType:
        type: aggregation
        selectedField: file_association
        filter: true
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      resultType: icdc_aggregation
    - name: filterCaseCountByFileType
      index:
        - files
      filterType:
        type: aggregation
        selectedField: file_type
        filter: true
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      resultType: icdc_aggregation
    - name: filterCaseCountByFileFormat
      index:
        - files
      filterType:
        type: aggregation
        selectedField: file_format
        filter: true
      dynamicFilter:
        index:
          - cases
        dynamicField: case_id
        targetField: all_case_ids
      resultType: icdc_aggregation
    - name: filterCaseCountByStudyParticipation
      index:
        - cases
      filterType:
        type: aggregation
        filter: true
        selectedField: study_participation
      resultType: icdc_aggregation
    - name: caseCountByProgram
      index:
        - cases
      filterType:
        type: nested
        selectedField: program
        nestedPath: program_info
        nestedFields:
          - program
      resultType: icdc_nested_list
    - name: caseCountByStudyCode
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: study_code
      resultType: icdc_aggregation
    - name: caseCountByStudyType
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: study_type
      resultType: icdc_aggregation
    - name: caseCountByStudyParticipation
      index:
        - cases
      filterType:
        type: aggregation
        selectedField: study_participation
      resultType: icdc_aggregation
    - name: caseCountByFileFormat
      index:
        - files
      filterType:
        type: aggregation
        selectedField: file_format
      resultType: icdc_aggregation
    - name: programsAndStudies
      index:
        - cases
      filterType:
        type: sub_aggregation
        selectedField: program
        #        selectedField: program
        subAggSelectedField: study
#      TODO Duplicate Arm Program
      resultType: icdc_arm_program